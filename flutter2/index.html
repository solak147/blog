<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><base href="/"><link href="css/bootstrap/bootstrap.min.css" rel="stylesheet"><link href="css/app.css" rel="stylesheet"><link href="Blog.styles.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap" rel="stylesheet"><link href="_content/MudBlazor/MudBlazor.min.css" rel="stylesheet"><link rel="stylesheet" href="css/a11y-dark.min.css"><link rel="stylesheet" href="css/custom.css"><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7750788533596067" crossorigin="anonymous"></script><!--!--><title>Flutter 什麼是Bloc Design Pattern</title><!--!--><!--!--><meta name="keywords" content="Flutter 什麼是Bloc Design Pattern" b-p6zcnqvy2k=""><!--!--><meta name="description" content=" Bloc 全名是「Business Logic Component」，用來分離UI層和商業邏輯層，有助於程式碼的維護、重複利用以及測試。
            Bloc 層會接收使用者的行為 (例如點擊Button)，根據不同的事件(Event)Bloc會去呼叫相應的函式(可能是去資料庫抓資料或使用 api )。
            之後根據結果回傳相應的狀態 (State) 給UI層，UI則根據狀態做變化。" b-p6zcnqvy2k=""><!--!--><meta property="og:title" content="Flutter 什麼是Bloc Design Pattern" b-p6zcnqvy2k=""><!--!--><meta property="og:description" content=" Bloc 全名是「Business Logic Component」，用來分離UI層和商業邏輯層，有助於程式碼的維護、重複利用以及測試。
            Bloc 層會接收使用者的行為 (例如點擊Button)，根據不同的事件(Event)Bloc會去呼叫相應的函式(可能是去資料庫抓資料或使用 api )。
            之後根據結果回傳相應的狀態 (State) 給UI層，UI則根據狀態做變化。" b-p6zcnqvy2k=""><!--!--><meta name="twitter:title" content="Flutter 什麼是Bloc Design Pattern" b-p6zcnqvy2k=""><!--!--><meta name="twitter:description" content=" Bloc 全名是「Business Logic Component」，用來分離UI層和商業邏輯層，有助於程式碼的維護、重複利用以及測試。
            Bloc 層會接收使用者的行為 (例如點擊Button)，根據不同的事件(Event)Bloc會去呼叫相應的函式(可能是去資料庫抓資料或使用 api )。
            之後根據結果回傳相應的狀態 (State) 給UI層，UI則根據狀態做變化。" b-p6zcnqvy2k=""></head><body style="background-color:#2b2c30"><div id="app" style="width:100vw;height:100vh"><!--!--><!--!--><!--!--><!--!--><!--!--><!--!--><!--!--> <!--!--><!--!--><!--!--><div class="page" b-p6zcnqvy2k=""><div class="sidebar" style="background-image:url(images/nav.jpg);background-repeat:no-repeat;background-size:cover" b-p6zcnqvy2k=""><!--!--><!--!--><header b-wtm1afifms=""><div class="top-row ps-3 navbar navbar-dark" b-wtm1afifms=""><div class="container-fluid" b-wtm1afifms=""><a class="navbar-brand" href="" b-wtm1afifms="">中二病也要寫程式</a></div></div></header><nav b-wtm1afifms=""><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none navlist" style="color:#fff;overflow-y:auto;height:95%"><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple mud-expanded"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Go</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon mud-transform" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-collapse-entered mud-navgroup-collapse" style="height:auto" _bl_2=""><div class="mud-collapse-wrapper" _bl_3=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./go1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->通道 Channel</div></a></div></div></div></div></div></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple mud-expanded"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">C#</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon mud-transform" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-collapse-entered mud-navgroup-collapse" style="height:auto" _bl_4=""><div class="mud-collapse-wrapper" _bl_5=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./csharp1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->C#基礎 - new vs overrvide</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./csharp2" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->ASP.NET Web API 訊息處理器</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./csharp3" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->多國語系</div></a></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Blazor</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-navgroup-collapse" style="" _bl_14=""><div class="mud-collapse-wrapper" _bl_15=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./blazor1" rel="" class="mud-nav-link"><div class="mud-nav-link-text">StateHasChanged() vs InvokeAsync(StateHasChanged)</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./blazor2" rel="" class="mud-nav-link"><div class="mud-nav-link-text">Service Lifetime</div></a></div></div></div></div></div></div></div></div></div></div></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple mud-expanded"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">JavaScript</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon mud-transform" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-collapse-entered mud-navgroup-collapse" style="height:auto" _bl_6=""><div class="mud-collapse-wrapper" _bl_7=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./javascript1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Promise 簡介</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./javascript2" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->使用 Promise 達到同步等待js資源載入</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./javascript3" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->傳統函式 VS 箭頭函式</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./javascript4" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Cookie、LocalStorage、SessionStorage 差異</div></a></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Vue</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-navgroup-collapse" style="" _bl_16=""><div class="mud-collapse-wrapper" _bl_17=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./vue1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Vue 生命週期</div></a></div></div></div></div></div></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Nuxt</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-navgroup-collapse" style="" _bl_18=""><div class="mud-collapse-wrapper" _bl_19=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./nuxt1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Nuxt 生命週期</div></a></div></div></div></div></div></div></div></div></div></div></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple mud-expanded"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Css</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon mud-transform" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-collapse-entered mud-navgroup-collapse" style="height:auto" _bl_8=""><div class="mud-collapse-wrapper" _bl_9=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./css1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->EM 與 REM 的差異</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./css2" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->VH、VW、VMIN、VMAX</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./css3" rel="" class="mud-nav-link"><div class="mud-nav-link-text">Display Flex</div></a></div></div></div></div></div></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple mud-expanded"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Dart</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon mud-transform" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-collapse-entered mud-navgroup-collapse" style="height:auto" _bl_10=""><div class="mud-collapse-wrapper" _bl_11=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./dart1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Dart基礎 - 初入dart</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./dart2" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Dart基礎 - @immutable</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./dart3" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Dart基礎 - 建構式</div></a></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Flutter</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-navgroup-collapse" style="" _bl_20=""><div class="mud-collapse-wrapper" _bl_21=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./flutter1" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->編譯錯誤 : missing an input or output annotation</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./flutter2" rel="" class="mud-nav-link active"><div class="mud-nav-link-text"><!--!-->什麼是 Bloc Design Pattern</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./flutter3" rel="" class="mud-nav-link"><div class="mud-nav-link-text">MaterialApp</div></a></div></div></div></div></div></div></div></div></div></div></div><!--!--><!--!--><div class="mud-nav-group"><button tabindex="0" class="mud-nav-link mud-ripple mud-expanded"><!--!--><svg class="mud-icon-root mud-icon-default mud-svg-icon mud-icon-size-medium mud-nav-link-icon mud-nav-link-icon-default" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M2 20h20v-4H2v4zm2-3h2v2H4v-2zM2 4v4h20V4H2zm4 3H4V5h2v2zm-4 7h20v-4H2v4zm2-3h2v2H4v-2z"></path></svg><div class="mud-nav-link-text">Web Deploy</div><!--!--><svg class="mud-icon-root mud-svg-icon mud-icon-size-medium mud-nav-link-expand-icon mud-transform" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><!--!--><path d="M0 0h24v24H0z" fill="none"></path><path d="M7 10l5 5 5-5z"></path></svg></button><!--!--><!--!--><div class="mud-collapse-container mud-collapse-entered mud-navgroup-collapse" style="height:auto" _bl_12=""><div class="mud-collapse-wrapper" _bl_13=""><div class="mud-collapse-wrapper-inner"><!--!--><div class="mud-navmenu mud-navmenu-default mud-navmenu-margin-none"><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./githubpage" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Blazor WebAssembly 使用 Github Pages 進行部屬</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./gcpvm" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->Google Cloud Platform 創建虛擬主機 (VM) 來架設網站</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./gcpdocker" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->使用 Docker 建立 MySQL</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./reactsnap" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->SEO 優化 - SPA react-snap 預渲染</div></a></div><!--!--><!--!--><div class="mud-nav-item mud-ripple"><!--!--><a href="./h5seo" rel="" class="mud-nav-link"><div class="mud-nav-link-text"><!--!-->SEO 優化 - HTM5 語意標籤（Semantic Elements)</div></a></div></div></div></div></div></div></div></nav></div><!--!--><main b-p6zcnqvy2k=""><article class="content px-4" b-p6zcnqvy2k=""><div b-p6zcnqvy2k=""><!--!--><!--!--><!--!--><h2><b>什麼是Bloc Design Pattern</b></h2><!--!--><p>Bloc 全名是「Business Logic Component」，用來分離UI層和商業邏輯層，有助於程式碼的維護、重複利用以及測試。</p><!--!--><h3><b>Bloc 的流程</b></h3><img src="images/flutter_2_1.png" alt="flutter_2_1" class="imgfmt" style="width:50%"><!--!--><p>Bloc 層會接收使用者的行為 (例如點擊Button)，根據不同的事件(Event)Bloc會去呼叫相應的函式(可能是去資料庫抓資料或使用 api )。 之後根據結果回傳相應的狀態 (State) 給UI層，UI則根據狀態做變化。</p><!--!--><h3><b>使用Flutter Bloc 套件</b></h3><!--!--><p>Flutter Bloc 套件是由Felix Angelov所開發的套件，能夠幫助開發人員實作 Bloc pattern。 他將 Bloc 包裝成更容易理解和維護的框架，而且把許多細節都幫我們做好了(例如關閉Stream、Log等等)。</p><!--!--><h3><b>Bloc Event</b></h3><!--!--><pre><code class="DART hljs language-java">
    <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Equatable</span> {
        LoginEvent([<span class="hljs-type">List</span> <span class="hljs-variable">props</span> <span class="hljs-operator">=</span> const []]) : <span class="hljs-built_in">super</span>(props);
    }

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailChanged</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">LoginEvent</span> {
        <span class="hljs-keyword">final</span> String email;

        EmailChanged({<span class="hljs-meta">@required</span> <span class="hljs-built_in">this</span>.email}) : <span class="hljs-built_in">super</span>([email]);

        <span class="hljs-meta">@override</span>
        String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> =&gt; <span class="hljs-string">'EmailChanged { email :$email }'</span>;
    }
</code></pre><!--!--><h3><b>Bloc State</b></h3><!--!--><pre><code class="DART hljs language-less">
    <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">LoginState</span> {
        <span class="hljs-selector-tag">bool</span> <span class="hljs-selector-tag">isEmailValid</span>;
        <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">bool</span> <span class="hljs-selector-tag">isPasswordValid</span>;

        <span class="hljs-selector-tag">LoginState</span>({
            <span class="hljs-variable">@required</span> this.isEmailValid,
            <span class="hljs-variable">@required</span> this.isPasswordValid,
        });

        <span class="hljs-selector-tag">factory</span> <span class="hljs-selector-tag">LoginState</span><span class="hljs-selector-class">.empty</span>() {
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">LoginState</span>(
                <span class="hljs-attribute">isEmailValid</span>: true,
                <span class="hljs-attribute">isPasswordValid</span>: true,
            );
        }
    }
</code></pre><!--!--><h3><b>Bloc</b></h3><!--!--><p>定義 Bloc 物件需先繼承套件提供的 Bloc class，並給予定義好的Event物件和State物件，和定義 Bloc 初始的State。<br>另外一定要實作的是mapEventToState，將接收到的Event用對應的商業邏輯(Business Logic)做處理，最後回傳包裝成Stream的State</p><!--!--><pre><code class="DART hljs language-csharp">
    <span class="hljs-keyword">class</span> <span class="hljs-title">LoginBloc</span> <span class="hljs-title">extends</span> <span class="hljs-title">Bloc</span>&lt;<span class="hljs-title">LoginEvent</span>, <span class="hljs-title">LoginState</span>&gt; {
        @override
        LoginState <span class="hljs-keyword">get</span> initialState =&gt; LoginState.<span class="hljs-keyword">init</span>();

        @override
        <span class="hljs-function">Stream&lt;LoginState&gt; <span class="hljs-title">mapEventToState</span>(<span class="hljs-params">LoginEvent <span class="hljs-keyword">event</span></span>) <span class="hljs-keyword">async</span>*</span> {
            <span class="hljs-comment">// 依照接收到的Event執行對應的方法</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span> <span class="hljs-keyword">is</span> LoginWithCredentialsPressed) {
                <span class="hljs-keyword">yield</span>* _mapLoginWithCredentialsPressedToState(
                email: <span class="hljs-keyword">event</span>.email,
                password: <span class="hljs-keyword">event</span>.password,
                );
            }
        }

        Stream&lt;LoginState&gt; _mapLoginWithCredentialsPressedToState({
            String email,
            String password,
        }) <span class="hljs-keyword">async</span>* {
            <span class="hljs-comment">// 使用帳號和密碼進行登入，成功就回傳sucess的State</span>
            <span class="hljs-comment">// 失敗則回傳Failure的State</span>
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">await</span> _userRepository.signInWithCredentials(email, password);
                <span class="hljs-keyword">yield</span> LoginState.success();
            } <span class="hljs-keyword">catch</span> (_) {
                <span class="hljs-keyword">yield</span> LoginState.failure();
            }
        }
    }
</code></pre><!--!--><h3><b>Dispatch</b></h3><!--!--><p>那麼該如何觸發Event呢?<br>Bloc內提供dispatch 方法可以用Event作為參數，它會觸發mapEventToState，接著就是執行Event與State的轉換。</p><!--!--><pre><code class="DART hljs language-java">
    <span class="hljs-comment">// 示意用程式碼</span>
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> {
        <span class="hljs-type">LoginBloc</span> <span class="hljs-variable">bloc</span> <span class="hljs-operator">=</span> LoginBloc();
        <span class="hljs-comment">// 略...</span>
        RaisedButton(
            onPressed: (){
                bloc.dispatch(LoginWithGooglePressed);
            },
            child: Text(<span class="hljs-string">'Google Login'</span>),
        )
    }
</code></pre><!--!--><h3><b>BlocProvider</b></h3><!--!--><p>在 Bloc package中，Widget 本身並不會直接擁有、或是直接參照 Bloc，而是透過 BlocProvider 將 Bloc、<br>以及用到這個 Bloc 的 Widget 綁起來，Widget 要在 Widget Tree 當中往上找到 BlocProvider 之後，再跟 BlocProvider 詢問 Bloc。<br><br>建立 BlocProvider 的方式像這樣。我們有一個上層的 Widget，裡頭包含了一個與登入相關的 AuthenticationBloc，<br>而我們 App 中的主要畫面都在 PageWidget 裡頭的話：</p><!--!--><pre><code class="DART hljs language-javascript">
    <span class="hljs-keyword">var</span> _bloc = <span class="hljs-title class_">AuthenticationBloc</span>();
    <span class="hljs-title class_">Widget</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">BuildContext context</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">BlocProvider</span>(
            <span class="hljs-attr">bloc</span>: _bloc,
            <span class="hljs-attr">child</span>: <span class="hljs-title class_">PageWidget</span>()),
        );
    }
</code></pre><!--!--><p>在 PageWidget，以及 PageWidget 以下任何一層的所有 children，都可以往上、在 build context 中找到 AuthenticationBloc：</p><!--!--><pre><code class="DART hljs language-swift">
    <span class="hljs-keyword">final</span> authenticationBloc <span class="hljs-operator">=</span> <span class="hljs-type">BlocProvider</span>.of<span class="hljs-operator">&lt;</span><span class="hljs-type">Bloc</span>&lt;<span class="hljs-type">AuthenticationEvent</span>, <span class="hljs-type">AuthenticationState</span>&gt;<span class="hljs-operator">&gt;</span>(context);
</code></pre><!--!--><h3><b>BlocBuilder</b></h3><!--!--><p>我們會希望 Bloc 在狀態更新之後，自動更新相關的 UI，而不是我們自己再去呼叫 setState()，<br>而 Bloc package 提供了 BlocBuilder，只要是這個 Bloc 發生變動，就會執行我們所指定的 WidgetBuilder。</p><!--!--><pre><code class="DART hljs language-kotlin">
    <span class="hljs-keyword">final</span> authenticationBloc = BlocProvider.of&lt;Bloc&lt;AuthenticationEvent, AuthenticationState&gt;&gt;(context);
    <span class="hljs-keyword">return</span> BlocBuilder&lt;AuthenticationEvent, AuthenticationState&gt;(
        bloc: authenticationBloc,
        builder: (context, state) {
            <span class="hljs-keyword">if</span> (state <span class="hljs-keyword">is</span> AuthenticatedState) {
                <span class="hljs-keyword">return</span> Text(<span class="hljs-string">'已登入 ${state.email}'</span>);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> Text(<span class="hljs-string">'尚未登入'</span>);
            }
        });
</code></pre></div></article></main></div><!--!--><!--!--></div><div id="blazor-error-ui">An unhandled error has occurred. <a href="" class="reload">Reload</a> <a class="dismiss">🗙</a></div><script src="_framework/blazor.webassembly.js"></script><script src="_content/MudBlazor/MudBlazor.min.js"></script><script src="js/highlight.min.js"></script><script src="js/javascript.js"></script></body></html>